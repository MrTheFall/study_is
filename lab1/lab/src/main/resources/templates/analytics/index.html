<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: layout(~{::body})}">

<body>
  <h2 class="text-2xl font-semibold mb-6">Аналитика</h2>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div class="bg-white rounded shadow p-4">
      <h3 class="font-medium mb-3">Количество организаций с заданным рейтингом</h3>
      <form method="get" class="flex gap-3">
        <input class="flex-1 border border-gray-300 rounded px-3 py-2" type="number" step="0.01" name="ratingEq"
          th:value="${ratingEq}">
        <button class="px-4 py-2 rounded border border-gray-300 hover:bg-gray-100 text-gray-700"
          type="submit">Посчитать</button>
      </form>
      <div class="mt-3 text-sm text-gray-700" th:if="${countRatingEq != null}">
        <b>Результат:</b> <span th:text="${countRatingEq}"></span>
      </div>
    </div>

    <div class="bg-white rounded shadow p-4">
      <h3 class="font-medium mb-3">Объекты, полное название начинается с подстроки</h3>
      <form method="get" class="flex gap-3">
        <input class="flex-1 border border-gray-300 rounded px-3 py-2" type="text" name="startsWith"
          th:value="${startsWith}">
        <button class="px-4 py-2 rounded border border-gray-300 hover:bg-gray-100 text-gray-700"
          type="submit">Найти</button>
      </form>
      <div class="mt-3 text-sm" th:if="${listStartsWith != null}">
        <ul class="list-disc list-inside" th:if="${!#lists.isEmpty(listStartsWith)}">
          <li th:each="o : ${listStartsWith}"><a class="text-indigo-600 hover:underline"
              th:href="@{'/organizations/' + ${o.id}}" th:text="${o.fullName}"></a></li>
        </ul>
        <p class="text-gray-500" th:if="${#lists.isEmpty(listStartsWith)}">Ничего не найдено</p>
      </div>
    </div>

    <div class="bg-white rounded shadow p-4">
      <h3 class="font-medium mb-3">Объекты, полное название больше заданного</h3>
      <form method="get" class="flex gap-3">
        <input class="flex-1 border border-gray-300 rounded px-3 py-2" type="text" name="fullNameGt"
          th:value="${fullNameGt}">
        <button class="px-4 py-2 rounded border border-gray-300 hover:bg-gray-100 text-gray-700"
          type="submit">Найти</button>
      </form>
      <div class="mt-3 text-sm" th:if="${listFullNameGt != null}">
        <ul class="list-disc list-inside" th:if="${!#lists.isEmpty(listFullNameGt)}">
          <li th:each="o : ${listFullNameGt}"><a class="text-indigo-600 hover:underline"
              th:href="@{'/organizations/' + ${o.id}}" th:text="${o.fullName}"></a></li>
        </ul>
        <p class="text-gray-500" th:if="${#lists.isEmpty(listFullNameGt)}">Ничего не найдено</p>
      </div>
    </div>

    <div class="bg-white rounded shadow p-4">
      <h3 class="font-medium mb-3">Топ-5 по годовому обороту</h3>
      <ol class="mt-3 pl-5 list-decimal text-sm">
        <li th:each="o : ${top5}"><a class="text-indigo-600 hover:underline" th:href="@{'/organizations/' + ${o.id}}"
            th:text="${o.name + ' (' + o.annualTurnover + ')'}"></a></li>
      </ol>
    </div>

    <div class="bg-white rounded shadow p-4">
      <h3 class="font-medium mb-3">Среднее сотрудников по топ-10 (оборот)</h3>
      <p class="mt-3 text-lg font-semibold" th:text="${avgTop10Employees}"></p>
    </div>
  </div>

</body>

</html>